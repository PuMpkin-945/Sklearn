# 模型评价和优化

## 欠拟合与过拟合

模型不合适，导致其无法对数据实现有效预测。

|   |训练数据|预测数据|
|---|---|---|
|欠拟合|不准确|不准确|
|过拟合|准确|不准确|
|好模型|准确|准确|

### 欠拟合

欠拟合可以通过观察训练数据及时发现，通过优化模型结果解决

### 过拟合（如何解决过拟合问题）
原因：
- 模型结构过于复杂，维度过高
- 使用了过多属性，模型训练时包含了干扰项信息

解决方法：
- 简化模型结构，如使用低阶模型
- 数据预处理，保留主成分信息
- 在模型训练时，增加正则化项(regularization)

$$
J = \frac{1}{2m} \sum_{i=1}^{m} {g(\theta,x_i)-y_i}^2} + \frac{\lambda}{2m}\sum_{j=1}^{n} {{\theta_j}^2}
$$

通过引入正则化项， $\lambda$取值大的情况下，可约束 $\theta$取值，有效控制各个属性数据的影响。

## 数据分离与混淆矩阵

使用准确率进行模型评估的局限性（空准确率）

### 混淆矩阵

混淆矩阵，又称为误差矩阵，用于衡量分类算法的准确程度。

||预测结果0|预测结果1|
|---|---|---|
|实际结果0|<span style="background-color: green;">True Negative|<span style="background-color: red;">False Positive|
|实际结果1|<span style="background-color: red;">False Negative|<span style="background-color: green;">True Positive|

**通过混淆矩阵，计算更丰富的模型评估指标**
![评估指标](https://github.com/PuMpkin-945/my_image/blob/fe527c355baeb2e577906b44b6d6d9470c3e0296/Confusion%20Matrix%20Related%20Formula.png)

## 模型优化

- 数据质量决定模型表现上限

**Always check:**
1. 数据属性的意义，是否为无关数据
2. 不同属性数据的数量级差异性如何
3. 是否有异常数据
4. 采集数据的方法是否合理。采集到的数据是否有代表性
5. 对于标签结果，要确保标签判定规则的一致性（统一标准）

**Always try:**
1. 删除不必要的属性
2. 数据预处理：归一化、标准化
3. 确定是否保留或过滤掉异常数据
4. 尝试不同的模型，对比模型表现

**Benefits:**
1. 减少过拟合、节约运算时间
2. 平衡数据影响，加快训练收敛
3. 提高鲁棒性
4. 帮助确定更合适的模型

- 尝试不同的模型
- 正则化

目标：在确定模型类别后，如何让模型表现更好
* 遍历核心参数组合，评估对应模型表现
* 扩大数据样本
* 增加或减少数据属性
* 对数据进行降维处理
* 对模型进行正则化处理，调整正则项 $\lambda$的数值